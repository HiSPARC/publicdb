---
- name: ensure local source directory exists
  file: path=/usr/local/src/hisparc state=directory
        owner=hisparc group=hisparc mode=2775
  become: true

- name: install shorewall core rpm
  yum: name={{ item }} state=present
  with_items:
      - http://france.shorewall.net/pub/CURRENT_STABLE_VERSION_IS_5.0/shorewall-5.0.15/shorewall-core-5.0.15-3.noarch.rpm
      - http://france.shorewall.net/pub/CURRENT_STABLE_VERSION_IS_5.0/shorewall-5.0.15/shorewall-5.0.15-3.noarch.rpm
      - http://france.shorewall.net/pub/CURRENT_STABLE_VERSION_IS_5.0/shorewall-5.0.15/shorewall-init-5.0.15-3.noarch.rpm
  become: true

- name: copy shorewall config
  copy: src=vpn-shorewall/ dest=/etc/shorewall backup=yes
  become: true
  notify: restart shorewall

- name: ensure shorewall is started
  service: name=shorewall enabled=yes state=started
  become: true
